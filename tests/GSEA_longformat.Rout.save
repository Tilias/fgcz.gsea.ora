
R version 3.5.2 (2018-12-20) -- "Eggshell Igloo"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin15.6.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> rm(list = ls())
> library(WebGestaltR)
******************************************

*                                        *

*          Welcome to WebGestaltR !      *

*                                        *

******************************************

> library(tidyverse)
── Attaching packages ─────────────────────────────────────── tidyverse 1.2.1 ──
✔ ggplot2 3.1.0.9000     ✔ purrr   0.3.0     
✔ tibble  2.0.1          ✔ dplyr   0.8.0.1   
✔ tidyr   0.8.2          ✔ stringr 1.3.1     
✔ readr   1.3.1          ✔ forcats 0.3.0     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
> library(fgczgseaora)


> library(org.Hs.eg.db)
Loading required package: AnnotationDbi
Loading required package: stats4
Loading required package: BiocGenerics
Loading required package: parallel

Attaching package: 'BiocGenerics'

The following objects are masked from 'package:parallel':

    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
    clusterExport, clusterMap, parApply, parCapply, parLapply,
    parLapplyLB, parRapply, parSapply, parSapplyLB

The following objects are masked from 'package:dplyr':

    combine, intersect, setdiff, union

The following objects are masked from 'package:stats':

    IQR, mad, sd, var, xtabs

The following objects are masked from 'package:base':

    Filter, Find, Map, Position, Reduce, anyDuplicated, append,
    as.data.frame, basename, cbind, colMeans, colSums, colnames,
    dirname, do.call, duplicated, eval, evalq, get, grep, grepl,
    intersect, is.unsorted, lapply, lengths, mapply, match, mget,
    order, paste, pmax, pmax.int, pmin, pmin.int, rank, rbind,
    rowMeans, rowSums, rownames, sapply, setdiff, sort, table, tapply,
    union, unique, unsplit, which, which.max, which.min

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.

Loading required package: IRanges
Loading required package: S4Vectors

Attaching package: 'S4Vectors'

The following objects are masked from 'package:dplyr':

    first, rename

The following object is masked from 'package:tidyr':

    expand

The following object is masked from 'package:base':

    expand.grid


Attaching package: 'IRanges'

The following objects are masked from 'package:dplyr':

    collapse, desc, slice

The following object is masked from 'package:purrr':

    reduce


Attaching package: 'AnnotationDbi'

The following object is masked from 'package:dplyr':

    select

> library(conflicted)
> 
> 
> # Setup -------------------------------------------------------------------
> 
> # fpath <- "inst/example_data/Contrasts_SignificanceValues_f_Cells_Treatment.csv"
> # dd <- read_csv(fpath)
> 
> dd <- contrast_data_example
> 
> colnames(dd) <- make.names(colnames(dd))
> 
> ddd <- getUniprotFromFastaHeader(dd)
Warning message:
Expected 2 pieces. Additional pieces discarded in 13761 rows [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...]. 
> 
> organism <- "hsapiens"
> ID_col <- "UniprotID"
> target <- "geneontology_Biological_Process"
> map_col <- "GO"
> nperm <- 10
> fc_col <- "estimate"
> contrast_col <- "lhs"
> outdir <- "GSEA"
> 
> contrs <- ddd %>%
+   distinct(!!sym(contrast_col)) %>%
+   pull()
> 
> 
> # Run ---------------------------------------------------------------------
> 
> sapply(contrs[1],
+        runGSEAlong,
+        organism = organism,
+        ID_col = ID_col,
+        target = target,
+        map_col = map_col,
+        nperm = nperm,
+        fc_col = fc_col,
+        contrast_col = contrast_col,
+        outdir = outdir)
Uploading the functional categories...
Uploading the ID list...
Summarize the uploaded ID list by GO Slim data...
Perform the enrichment analysis...
10 permutations of score complete...
Begin affinity propagation...
End affinity propagation...
Begin weighted set cover...
End weighted set cover...
Generate the final report...
Results can be found in the GSEA_geneontology_Biological_Process/Project_Treatment..wodox...wdox!
Parsed with column specification:
cols(
  userId = col_character(),
  geneSymbol = col_character(),
  geneName = col_character(),
  entrezgene = col_double(),
  score = col_double(),
  gLink = col_character()
)


processing file: GSEA.Rmd
   inline R code fragments

label: setup (with options) 
List of 1
 $ include: logi FALSE

   inline R code fragments

label: unnamed-chunk-1
  ordinary text without R code

label: unnamed-chunk-2
  ordinary text without R code

label: unnamed-chunk-3 (with options) 
List of 4
 $ fig.cap: chr "Heatmap of Score patterns in significantly enriched pathways identified by GSEA"
 $ fig.asp: num 2
 $ include: logi FALSE
 $ eval   : logi FALSE

  ordinary text without R code

label: unnamed-chunk-4 (with options) 
List of 1
 $ fig.cap: chr "Intersection sizes between significantly enriched pathways identified by GSEA visualised using the `UpSetR` package"

  ordinary text without R code

label: unnamed-chunk-5 (with options) 
List of 1
 $ results: chr "asis"

  ordinary text without R code

output file: GSEA.knit.md

/usr/local/bin/pandoc +RTS -K512m -RTS GSEA.utf8.md --to html4 --from markdown+autolink_bare_uris+ascii_identifiers+tex_math_single_backslash+smart --output GSEA.html --email-obfuscation none --self-contained --wrap preserve --standalone --section-divs --template /Library/Frameworks/R.framework/Versions/3.5/Resources/library/rmarkdown/rmd/h/default.html --no-highlight --variable highlightjs=1 --variable 'theme:bootstrap' --include-in-header /var/folders/x8/43hfd3t55mv2crz8nlqk08th0000gn/T//RtmplQ38UO/rmarkdown-str72446b999f95.html --mathjax --variable 'mathjax-url:https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML' --filter /usr/local/bin/pandoc-citeproc 

Output created: GSEA.html
                                                                                                            Treatment: wodox - wdox 
"/Users/Lucas/Dropbox/FGCZ/fgczgseaora.Rcheck/tests/GSEA_geneontology_Biological_Process/Project_Treatment..wodox...wdox/GSEA.html" 
There were 50 or more warnings (use warnings() to see the first 50)
> 
> proc.time()
   user  system elapsed 
 40.115   3.587  63.530 
