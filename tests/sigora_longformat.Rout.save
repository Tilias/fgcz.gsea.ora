
R version 3.5.2 (2018-12-20) -- "Eggshell Igloo"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin15.6.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # Run Script for long format
> 
> rm(list = ls())
> 
> library(org.Hs.eg.db)
Loading required package: AnnotationDbi
Loading required package: stats4
Loading required package: BiocGenerics
Loading required package: parallel

Attaching package: 'BiocGenerics'

The following objects are masked from 'package:parallel':

    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
    clusterExport, clusterMap, parApply, parCapply, parLapply,
    parLapplyLB, parRapply, parSapply, parSapplyLB

The following objects are masked from 'package:stats':

    IQR, mad, sd, var, xtabs

The following objects are masked from 'package:base':

    Filter, Find, Map, Position, Reduce, anyDuplicated, append,
    as.data.frame, basename, cbind, colMeans, colSums, colnames,
    dirname, do.call, duplicated, eval, evalq, get, grep, grepl,
    intersect, is.unsorted, lapply, lengths, mapply, match, mget,
    order, paste, pmax, pmax.int, pmin, pmin.int, rank, rbind,
    rowMeans, rowSums, rownames, sapply, setdiff, sort, table, tapply,
    union, unique, unsplit, which, which.max, which.min

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.

Loading required package: IRanges
Loading required package: S4Vectors

Attaching package: 'S4Vectors'

The following object is masked from 'package:base':

    expand.grid


> library(sigora)
> library(tidyverse)
── Attaching packages ─────────────────────────────────────── tidyverse 1.2.1 ──
✔ ggplot2 3.1.0.9000     ✔ purrr   0.3.0     
✔ tibble  2.0.1          ✔ dplyr   0.8.0.1   
✔ tidyr   0.8.2          ✔ stringr 1.3.1     
✔ readr   1.3.1          ✔ forcats 0.3.0     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ ggplot2::Position() masks BiocGenerics::Position(), base::Position()
✖ dplyr::collapse()   masks IRanges::collapse()
✖ dplyr::combine()    masks Biobase::combine(), BiocGenerics::combine()
✖ dplyr::desc()       masks IRanges::desc()
✖ tidyr::expand()     masks S4Vectors::expand()
✖ dplyr::filter()     masks stats::filter()
✖ dplyr::first()      masks S4Vectors::first()
✖ dplyr::lag()        masks stats::lag()
✖ purrr::reduce()     masks IRanges::reduce()
✖ dplyr::rename()     masks S4Vectors::rename()
✖ dplyr::select()     masks AnnotationDbi::select()
✖ dplyr::slice()      masks IRanges::slice()
> library(GO.db)

> library(slam)
> library(fgczgseaora)
> 
> 
> # Setup -------------------------------------------------------------------
> 
> # fpath <- "inst/example_data/Contrasts_SignificanceValues_f_Cells_Treatment.csv"
> # dd <- read_csv(fpath)
> 
> dd <- contrast_data_example
> colnames(dd) <- make.names(colnames(dd))
> 
> ddd <- getUniprotFromFastaHeader(dd)
Warning message:
Expected 2 pieces. Additional pieces discarded in 13761 rows [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...]. 
> 
> con_col <- "lhs"
> greater <- TRUE # TRUE: Greater than threshold, FALSE: Smaller than threshold
> target <- "GO"
> fc_col <- "estimate"
> fc_threshold <- 0.5
> outdir <- "sigORA"
> 
> contrs <- ddd %>%
+   distinct(!!sym(con_col)) %>%
+   pull()
> 
> 
> # Run ---------------------------------------------------------------------
> 
> sapply(contrs[1],
+        runSIGORAlong,
+        target = target,
+        fc_col = fc_col,
+        greater = greater,
+        fc_threshold = fc_threshold,
+        outdir = outdir)
'select()' returned 1:many mapping between keys and columns
'select()' returned 1:1 mapping between keys and columns
Joining, by = "pathwayID"
'select()' returned 1:many mapping between keys and columns
'select()' returned 1:1 mapping between keys and columns
Joining, by = "pathwayID"
Garbage collection 49 = 30+6+13 (level 2) ... 
184.1 Mbytes of cons cells used (51%)
67.8 Mbytes of vectors used (24%)
Time difference of 15.95234 secs
Garbage collection 84 = 62+8+14 (level 2) ... 
184.3 Mbytes of cons cells used (51%)
53.1 Mbytes of vectors used (23%)
Time difference of 16.43688 secs
Garbage collection 85 = 62+8+15 (level 2) ... 
184.3 Mbytes of cons cells used (51%)
52.6 Mbytes of vectors used (29%)
Time difference of 16.82342 secs
Garbage collection 86 = 62+8+16 (level 2) ... 
184.3 Mbytes of cons cells used (51%)
52.6 Mbytes of vectors used (29%)
Time difference of 17.2053 secs
[1] pathwy.id   description pvalues     Bonferroni  successes   PathwaySize
[7] N           sample.size
<0 rows> (or 0-length row.names)
Joining, by = "pathwayId"
Joining, by = "gene"
Error in sigora_heatmap(sigora_res, GPStab) : 
  all(dim(tab4) > 0) is not TRUE
In addition: Warning messages:
1: Column `pathwayId` joining factors with different levels, coercing to character vector 
2: Column `gene` joining factor and character vector, coercing into character vector 


processing file: sigora.Rmd
   inline R code fragments

label: setup (with options) 
List of 1
 $ include: logi FALSE

   inline R code fragments

label: unnamed-chunk-1
  ordinary text without R code

label: resulttab
  ordinary text without R code

label: unnamed-chunk-2
  ordinary text without R code

label: unnamed-chunk-3
  ordinary text without R code

label: unnamed-chunk-4 (with options) 
List of 3
 $ fig.cap   : chr "Heatmap of fold change patterns in significantly enriched pathways identified by sigORA."
 $ fig.width : num 10
 $ fig.height: num 20

No pathways to visualise
  ordinary text without R code

label: unnamed-chunk-5 (with options) 
List of 1
 $ fig.cap: chr "Intersection sizes between significantly enriched pathways identified by sigORA visualised using the UpSetR package"

Joining, by = "pathwayId"
Joining, by = "gene"
  ordinary text without R code

label: unnamed-chunk-6
  ordinary text without R code

output file: sigora.knit.md

/usr/local/bin/pandoc +RTS -K512m -RTS sigora.utf8.md --to html4 --from markdown+autolink_bare_uris+ascii_identifiers+tex_math_single_backslash+smart --output sigora.html --email-obfuscation none --self-contained --wrap preserve --standalone --section-divs --template /Library/Frameworks/R.framework/Versions/3.5/Resources/library/rmarkdown/rmd/h/default.html --no-highlight --variable highlightjs=1 --variable 'theme:bootstrap' --include-in-header /var/folders/x8/43hfd3t55mv2crz8nlqk08th0000gn/T//RtmpVB79B2/rmarkdown-str72751aa45164.html --mathjax --variable 'mathjax-url:https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML' --filter /usr/local/bin/pandoc-citeproc 

Output created: sigora.html
                                                                           Treatment: wodox - wdox 
"/Users/Lucas/Dropbox/FGCZ/fgczgseaora.Rcheck/tests/sigORA_GO/Treatment..wodox...wdox/sigora.html" 
Warning messages:
1: Column `pathwayId` joining factors with different levels, coercing to character vector 
2: Column `gene` joining factor and character vector, coercing into character vector 
> 
> 
> proc.time()
   user  system elapsed 
 32.720   3.716  37.162 
